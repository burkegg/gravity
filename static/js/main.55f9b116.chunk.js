(this.webpackJsonpgravity=this.webpackJsonpgravity||[]).push([[0],{14:function(t,e,n){},16:function(t,e,n){"use strict";n.r(e);var a=n(0),s=n(2),i=n.n(s),o=n(8),l=n.n(o),r=(n(14),n(1)),c=n(3),u=n(4),h=n(6),d=n(5),g=n(15),f=function t(e){var n=this;Object(c.a)(this,t),this.addBall=function(t){t={pos:new g(t.x,t.y),vel:new g(t.Vx,t.Vy),mass:t.mass,color:t.color},n.ballsList.push(t)},this.getBalls=function(){return Object(r.a)(n.ballsList)},this.getColors=function(){return Object(r.a)(n.colors)},this.editBallLocation=function(t,e){var a=n.ballsList[t];a.pos&&(a.pos.x=e.x,a.pos.y=e.y)},this.editBallVelocity=function(t,e){if(e){var a=n.ballsList[t],s=(a.vel.x,a.vel.y,a.pos.x,a.pos.y,new g(a.pos.x,a.pos.y)),i=new g(e.x,e.y);i.subtract(s),a.vel.x=i.x,a.vel.y=i.y}},this.getLatestData=function(){var t=n.locHistory,e=[];return t.forEach((function(t,n){e.push(t[t.length-1])})),e},this.resetBallLocations=function(t){n.ballsList=Object(r.a)(t)},this.changeMass=function(t,e){console.log("balls",n.ballsList,e),n.ballsList[e].mass=t},this.getDataToAnimate=function(t){var e=n.locHistory;if(t<0)throw new Error("You went below zero");for(var a=[],s=n.getInfo().numBalls,i=0;i<s;i++)e[i][t]&&e[i][t].pos||(t=e[1].length-1),a.push(e[i][t]);return a},this.manageBalls=function(){window.setInterval((function(){n.ballsList.forEach((function(t,e){for(var a=0;a<5e3;a++)n.moveBall(e)}))}),5e3)},this.moveAllBallSteps=function(){var t=[];return n.ballsList.forEach((function(e,a){var s=n.moveBallSteps(a);t.push(s)})),t},this.clearBallsList=function(){n.ballsList=[]},this.moveBallSteps=function(t){for(var e=[],a=0;a<1e3;a++)n.ballsList.forEach((function(t,a){var s=n.applyForce(a);e[a]=s}));return e},this.applyForce=function(t){var e=n.ballsList,a=new g(0,0),s=new g(0,0);a.copy(e[t].vel),s.copy(e[t].pos);var i=e[t].color,o=e[t].mass,l=n.calcNetForce(t),r=new g(0,0);r.copy(l);var c=new g(o,o),u=r.divide(c);u.multiplyScalar(n.sizeTimestep);var h=new g(a.x,a.y),d=new g(e[t].pos.x,e[t].pos.y);h.add(u);var f=new g(h.x,h.y);f.multiplyScalar(n.sizeTimestep),d.add(f);var m={pos:d,vel:h,mass:o,color:i};return n.ballsList[t]=m,m},this.updateHistory=function(t,e){n.locHistory[t].push(e)},this.calcNetForce=function(t){var e=n.ballsList,a=new g(0,0);return e.forEach((function(s,i){if(t!==i){var o=n.calcOneForce(e[t],e[i]);a.add(o)}})),a},this.getInfo=function(){return{gravConstant:n.G,numBalls:n.ballsList.length,numTimesteps:n.numTimesteps,sizeTimestep:n.sizeTimestep,currTimestep:n.currTimestep}},this.calcOneForce=function(t,e){var a=t.pos.distanceSq(e.pos),s=n.G*t.mass*e.mass/(a+.2*a);a<5&&(s=0);var i={};i.pos=new g(0,0),i.pos.copy(e.pos);var o=i.pos.subtract(t.pos);return o.normalize(),o.multiplyScalar(s),o},this.ballsList=[],this.G=e,this.locHistory=[],this.currTimestep=0,this.numTimesteps=0,this.sizeTimestep=5e-5},m=function(t){t.animationInfo;var e={height:30,fontSize:20,borderStyle:"solid",borderColor:"black",marginBottom:15};return Object(a.jsxs)("div",{id:"rightSide",style:{display:"flex",flexDirection:"column",marginLeft:15},children:[Object(a.jsx)("h2",{id:"rightSideHeader",children:"Set up Sim"}),Object(a.jsxs)("div",{id:"addRemoveButtons",style:{display:"flex",flexDirection:"column"},children:[Object(a.jsx)("label",{htmlFor:"numBallSelect",style:{marginBottom:5},children:"Select number of objects:"}),Object(a.jsxs)("select",{name:"Number",id:"numBallSelect",onChange:t.selectNumberBalls,disabled:t.running,style:{marginBottom:15,height:30,fontSize:20},children:[Object(a.jsx)("option",{value:"select...",children:"Select..."}),Object(a.jsx)("option",{value:"1",children:"One"}),Object(a.jsx)("option",{value:"2",children:"Two"}),Object(a.jsx)("option",{value:"3",children:"Three"}),Object(a.jsx)("option",{value:"4",children:"Four"})]}),Object(a.jsx)("button",{className:"ballsButton",onClick:t.startHandler,disabled:!t.animationInfo.length,style:e,children:t.running?"Stop":"Start"}),Object(a.jsx)("button",{className:"ballsButton",onClick:t.reset,disabled:t.running,style:e,children:"Reset"}),Object(a.jsxs)("div",{children:[Object(a.jsx)("input",{type:"checkbox",id:"traceBox",name:"traceBox",value:"traces",onChange:t.toggleTraces,style:{width:20,height:20}}),Object(a.jsx)("label",{htmlFor:"traceBox",children:"Show Traces"})]}),Object(a.jsxs)("div",{id:"mass-section",children:[t.animationInfo.map((function(e,n){return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{style:{marginTop:20,fontSize:16,marginBottom:5},children:Object(a.jsxs)("label",{htmlFor:"mass".concat(n),children:["Mass for object ",n+1]})}),Object(a.jsx)("div",{style:{marginBottom:20},children:Object(a.jsx)("input",{onChange:t.handleChangeMass,type:"number",id:"massEntry".concat(n),name:"".concat(n),min:"1",max:"1000",placeholder:"".concat(e.mass),style:{width:100,height:30,fontSize:17,textAlign:"center"}})})]},"$mass".concat(n,"key"))})),t.animationInfo.length&&Object(a.jsx)("div",{children:"heyheyhey"})]})]}),Object(a.jsx)("div",{style:{position:"absolute",bottom:100,width:200},children:"Drag masses and vectors to edit starting conditions."})]})},v=function(t){Object(h.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).drawArrows=function(){var t=a.canvasRef.current.getContext("2d"),e=a.props,n=e.running,s=e.locations;n||s.forEach((function(e,n){var s=Math.sqrt(Math.pow(e.vel.x,2)+Math.pow(e.vel.y,2)),i=e.pos,o=e.vel;t.save(),t.translate(i.x,i.y),t.rotate(a.angleBetweenPoints(o)*Math.PI/180),t.translate(-i.x,-i.y);var l=new Path2D;l.moveTo(-5+i.x,0+i.y+5),l.lineTo(5+i.x,0+i.y+5),l.lineTo(5+i.x,s+i.y+5),l.lineTo(15+i.x,s+i.y+5),l.lineTo(0+i.x,s+20+i.y+5),l.lineTo(-15+i.x,s+i.y+5),l.lineTo(-5+i.x,s+i.y+5),l.closePath(),t.stroke(l),t.fill(l),a.arrows[n]=l,t.restore()}))},a.angleBetweenPoints=function(t){return 180*Math.atan2(t.y,t.x)/Math.PI-90},a.addBallEventListeners=function(){var t=a.canvasRef.current,e=t.getContext("2d"),n=a.props,s=n.running,i=n.allowDragging,o=a.ballLocs;!s&&i&&(t.addEventListener("mousedown",(function(t){s||(t.preventDefault(),t.stopPropagation(),o.forEach((function(n,s){(function(t,n,s){var i=a.arrows[n],o=t.pos,l=t.vel;return e.save(),e.translate(o.x,o.y),e.rotate(a.angleBetweenPoints(l)*Math.PI/180),e.translate(-o.x,-o.y),e.isPointInPath(i,s.offsetX,s.offsetY)?(e.restore(),!0):(e.restore(),!1)})(n,s,t)&&a.setState({draggingVectorIdx:s,isVectorDragging:!0})})),a.circles.forEach((function(n,s){e.isPointInPath(n,t.offsetX,t.offsetY)&&a.setState({isDragging:!0,whichBall:s})})))})),t.addEventListener("mouseup",(function(t){t.preventDefault(),t.stopPropagation(),a.setState({isDragging:!1,whichBall:null,isVectorDragging:!1,draggingVectorIdx:null})})),t.addEventListener("mousemove",(function(t){if(!s&&a.state.isDragging){t.preventDefault(),t.stopPropagation();var e=a.getMousePos(t);a.props.handleDragDrop(e,a.state.whichBall)}else if(!s&&a.state.isVectorDragging){var n=a.getMousePos(t);a.props.handleVectorDrag(n,a.state.draggingVectorIdx)}})))},a.showBall=function(t,e,n,s,i){var o,l=a.canvasRef.current.getContext("2d"),r=new Path2D;o=n>800?15:n>600?12:n>400?10:n>100?8:6,r.arc(Math.round(t),Math.round(e),o,0,2*Math.PI),l.fillStyle=i,l.fill(r),a.circles[s]=r},a.backGround=function(){var t=a.canvasRef.current.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height)},a.state={listeners:[],isDragging:!1,whichBall:null,dragOk:!1,receivedLocs:!1},a.canvasRef=i.a.createRef(),a.circles=[],a.arrows=[],a.ballLocs=[],a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.canvasRef.current.width=.8*document.getElementById("canvasContainer").clientWidth,this.canvasRef.current.height=document.getElementById("canvasContainer").clientHeight}},{key:"componentDidUpdate",value:function(){var t=this,e=this.props.locations;this.ballLocs=Object(r.a)(e);this.canvasRef.current;this.props.traces||this.backGround(),e.forEach((function(e,n){t.showBall(e.pos.x,e.pos.y,e.mass,n,e.color)})),this.drawArrows(),e.length&&!this.state.receivedLocs&&this.setState({receivedLocs:!0},(function(){t.addBallEventListeners()}))}},{key:"getMousePos",value:function(t){var e=this.canvasRef.current.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}},{key:"render",value:function(){return Object(a.jsx)("canvas",{ref:this.canvasRef,style:{border:1,borderStyle:"solid",backgroundColor:"MidnightBlue"}})}}]),n}(i.a.Component),p=function(t){Object(h.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).updateAnimationState=function(){a.state.running&&a.balls.ballsList.forEach((function(t,e){var n=a.balls.moveBallSteps();a.setState({animationInfo:n})})),a.rAF=requestAnimationFrame(a.updateAnimationState)},a.selectNumberBalls=function(t){var e=a.balls;switch(e.clearBallsList(),t.target.value){case"1":e.addBall({x:500,y:500,Vx:0,Vy:1,mass:1e3,color:"yellow"});break;case"2":e.addBall({x:500,y:500,Vx:0,Vy:-20,mass:1e3,color:"yellow"}),e.addBall({x:50,y:500,Vx:0,Vy:-25,mass:20,color:"aqua"});break;case"3":e.addBall({x:500,y:500,Vx:0,Vy:1,mass:1e3,color:"yellow"}),e.addBall({x:870,y:500,Vx:0,Vy:-25,mass:20,color:"aqua"}),e.addBall({x:890,y:500,Vx:0,Vy:-10,mass:1,color:"springGreen"});break;case"4":e.addBall({x:500,y:500,Vx:0,Vy:1,mass:1e3,color:"yellow"}),e.addBall({x:870,y:500,Vx:0,Vy:-25,mass:20,color:"aqua"}),e.addBall({x:890,y:500,Vx:0,Vy:-10,mass:1,color:"springGreen"}),e.addBall({x:250,y:200,Vx:5,Vy:5,mass:1,color:"red"})}a.setInitBallInfoState()},a.stopStart=function(t){a.setState({running:!a.state.running})},a.handleDragDrop=function(t,e){a.setState({allowDragging:!1});a.state.animationInfo[e];a.balls.editBallLocation(e,t);var n=a.balls.getBalls();a.setState({animationInfo:n,initPositions:Object(r.a)(n)}),a.setInitBallInfoState()},a.handleVectorDrag=function(t,e){a.setState({allowDragging:!1}),a.balls.editBallVelocity(e,t);var n=a.balls.getBalls();a.setState({animationInfo:n,initPositions:Object(r.a)(n)})},a.resetPositionsToInit=function(){a.balls.resetBallLocations(a.state.initPositions),a.setState({animationInfo:Object(r.a)(a.state.initPositions)})},a.setInitBallInfoState=function(){var t=a.balls.getBalls();a.setState({animationInfo:t,initPositions:Object(r.a)(t)})},a.toggleTraces=function(t){a.setState({traces:!a.state.traces})},a.handleChangeMass=function(t){var e=t.target.valueAsNumber,n=parseInt(t.target.id[t.target.id.length-1]);if("number"===typeof e&&e>0){a.balls.changeMass(e,n);var s=a.balls.getBalls();a.setState({animationInfo:s,initPositions:Object(r.a)(s)})}},a.state={animationInfo:[],running:!1,showTraces:!1,allowDragging:!0,isDragging:!1,initPositions:[],draggingVectorIdx:!1,isVectorDragging:!1},a.balls=new f(400),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.rAF=requestAnimationFrame(this.updateAnimationState)}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rAF)}},{key:"render",value:function(){return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(v,{locations:this.state.animationInfo,running:this.state.running,traces:this.state.traces,allowDragging:this.state.allowDragging,handleDragDrop:this.handleDragDrop,handleVectorDrag:this.handleVectorDrag,handleVectorDown:this.handleVectorDown}),Object(a.jsx)(m,{running:this.state.running,startHandler:this.stopStart,selectNumberBalls:this.selectNumberBalls,animationInfo:this.state.animationInfo,toggleTraces:this.toggleTraces,reset:this.resetPositionsToInit,handleChangeMass:this.handleChangeMass})]})}}]),n}(i.a.Component);var b=function(){return Object(a.jsx)("div",{className:"App",style:{display:"flex",flexDirection:"row",height:"98vh"},children:Object(a.jsx)("div",{id:"canvasContainer",style:{display:"flex",flexDirection:"row",width:"100%",marginTop:10,marginLeft:10,marginBottom:10,minHeight:"100%"},children:Object(a.jsx)(p,{})})})},y=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(e){var n=e.getCLS,a=e.getFID,s=e.getFCP,i=e.getLCP,o=e.getTTFB;n(t),a(t),s(t),i(t),o(t)}))};l.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(b,{})}),document.getElementById("root")),y()}},[[16,1,2]]]);
//# sourceMappingURL=main.55f9b116.chunk.js.map