(this.webpackJsonpgravity=this.webpackJsonpgravity||[]).push([[0],{14:function(t,e,a){},16:function(t,e,a){"use strict";a.r(e);var n=a(0),i=a(2),s=a.n(i),o=a(8),r=a.n(o),l=(a(14),a(1)),c=a(3),d=a(4),h=a(6),u=a(5);function g(){return new Worker(a.p+"static/js/calc.worker.c00cd5d9.worker.js")}var f=a(15),m=function t(e){var a=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(c.a)(this,t),this.makeThreads=function(t){for(var e=0;e<t;e++)a.threadPool.push(new g)},this.addBall=function(t){var e=new f(t.x,t.y),n=new f(t.Vx,t.Vy),i=a.initData.length;t={pos:e,vel:n,mass:t.mass,color:t.color,ballIdx:i},a.initData.push(t),a.nextData.push(t)},this.getBalls=function(){return Object(l.a)(a.nextData)},this.editBallLocation=function(t,e){var n=a.initData[t];n.pos&&(n.pos.x=e.x,n.pos.y=e.y),a.nextData=Object(l.a)(a.initData)},this.updateBallData=function(t){a.initData=Object(l.a)(t),a.nextData=Object(l.a)(t)},this.editBallVelocity=function(t,e){if(e){var n=a.initData[t],i=new f(n.pos.x,n.pos.y),s=new f(e.x,e.y);s.subtract(i),n.vel.x=s.x,n.vel.y=s.y,a.nextData=Object(l.a)(a.initData)}},this.resetBallLocations=function(t){a.initData=Object(l.a)(t),a.nextData=Object(l.a)(t)},this.changeMass=function(t,e){a.initData[e].mass=t,a.nextData[e].mass=t},this.clearBallsList=function(){a.initData=[],a.nextData=[]},this.moveBallSteps=function(){for(var t=function(t){var e=[];a.initData.forEach((function(t,n){var i=a.applyForce(t);e[n]=i})),a.initData=e},e=0;e<1e4;e++)t();return a.initData},this.applyForce=function(t){var e=a.calcNetForce(t.ballIdx),n=new f(t.mass,t.mass);e.divide(n),e.multiplyScalar(a.sizeTimestep);var i=new f(t.vel.x,t.vel.y),s=new f(t.pos.x,t.pos.y);i.add(e);var o=new f(i.x,i.y);return o.multiplyScalar(a.sizeTimestep),s.add(o),{pos:s,vel:i,mass:t.mass,color:t.color,ballIdx:t.ballIdx}},this.calcNetForce=function(t){var e=a.initData,n=new f(0,0);return e.forEach((function(i,s){if(t!==s){var o=a.calcOneForce(e[t],e[s]);n.add(o)}})),n},this.calcOneForce=function(t,e){var n=t.pos.distanceSq(e.pos),i=a.G*t.mass*e.mass/(n+.2*n);n<5&&(i=0);var s={};s.pos=new f(0,0),s.pos.copy(e.pos);var o=s.pos.subtract(t.pos);return o.normalize(),o.multiplyScalar(i),o},this.ballsList=[],this.G=e,this.numThreads=n,this.currTimestep=0,this.numTimesteps=0,this.sizeTimestep=15e-6,this.initData=[],this.nextData=[],this.threadPool=[],this.dataIdx=0,this.worker=new g},v=function(t){t.animationInfo;var e={height:30,fontSize:20,borderStyle:"solid",borderColor:"black",marginBottom:15};return Object(n.jsxs)("div",{id:"rightSide",style:{display:"flex",flexDirection:"column",marginLeft:15},children:[Object(n.jsx)("h2",{id:"rightSideHeader",children:"Set up Sim"}),Object(n.jsxs)("div",{id:"addRemoveButtons",style:{display:"flex",flexDirection:"column"},children:[Object(n.jsx)("label",{htmlFor:"numBallSelect",style:{marginBottom:5},children:"Select number of objects:"}),Object(n.jsxs)("select",{name:"Number",id:"numBallSelect",onChange:t.selectNumberBalls,disabled:t.running,style:{marginBottom:15,height:30,fontSize:20},children:[Object(n.jsx)("option",{value:"select...",children:"Select..."}),Object(n.jsx)("option",{value:"1",children:"One"}),Object(n.jsx)("option",{value:"2",children:"Two"}),Object(n.jsx)("option",{value:"3",children:"Three"}),Object(n.jsx)("option",{value:"4",children:"Four"})]}),Object(n.jsx)("button",{className:"ballsButton",onClick:t.startHandler,disabled:!t.animationInfo.length,style:e,children:t.running?"Stop":"Start"}),Object(n.jsx)("button",{className:"ballsButton",onClick:t.reset,disabled:t.running,style:e,children:"Reset"}),Object(n.jsxs)("div",{children:[Object(n.jsx)("input",{type:"checkbox",id:"traceBox",name:"traceBox",value:"traces",onChange:t.toggleTraces,style:{width:20,height:20}}),Object(n.jsx)("label",{htmlFor:"traceBox",children:"Show Traces"})]}),Object(n.jsx)("div",{id:"mass-section",children:t.animationInfo.map((function(e,a){return Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{style:{marginTop:20,fontSize:16,marginBottom:5},children:Object(n.jsxs)("label",{htmlFor:"mass".concat(a),children:["Mass for object ",a+1]})}),Object(n.jsx)("div",{style:{marginBottom:20},children:Object(n.jsx)("input",{onChange:t.handleChangeMass,type:"number",id:"massEntry".concat(a),name:"".concat(a),min:"1",max:"1000",placeholder:"".concat(e.mass),style:{width:100,height:30,fontSize:17,textAlign:"center"}})})]},"$mass".concat(a,"key"))}))})]}),Object(n.jsx)("div",{style:{position:"absolute",bottom:100,width:200},children:"Drag masses and vectors to edit starting conditions."})]})},p=function(t){Object(h.a)(a,t);var e=Object(u.a)(a);function a(t){var n;return Object(c.a)(this,a),(n=e.call(this,t)).drawArrows=function(){var t=n.canvasRef.current.getContext("2d"),e=n.props,a=e.running,i=e.locations;a||i.forEach((function(e,a){var i=Math.sqrt(Math.pow(e.vel.x,2)+Math.pow(e.vel.y,2)),s=e.pos,o=e.vel;t.save(),t.translate(s.x,s.y),t.rotate(n.angleBetweenPoints(o)*Math.PI/180),t.translate(-s.x,-s.y);var r=new Path2D;r.moveTo(-5+s.x,0+s.y+5),r.lineTo(5+s.x,0+s.y+5),r.lineTo(5+s.x,i+s.y+5),r.lineTo(15+s.x,i+s.y+5),r.lineTo(0+s.x,i+20+s.y+5),r.lineTo(-15+s.x,i+s.y+5),r.lineTo(-5+s.x,i+s.y+5),r.closePath(),t.stroke(r),t.fill(r),n.arrows[a]=r,t.restore()}))},n.angleBetweenPoints=function(t){return 180*Math.atan2(t.y,t.x)/Math.PI-90},n.addBallEventListeners=function(){var t=n.canvasRef.current,e=t.getContext("2d"),a=n.props,i=a.running,s=a.allowDragging,o=n.ballLocs;!i&&s&&(t.addEventListener("mousedown",(function(t){i||(t.preventDefault(),t.stopPropagation(),o.forEach((function(a,i){(function(t,a,i){var s=n.arrows[a],o=t.pos,r=t.vel;return e.save(),e.translate(o.x,o.y),e.rotate(n.angleBetweenPoints(r)*Math.PI/180),e.translate(-o.x,-o.y),e.isPointInPath(s,i.offsetX,i.offsetY)?(e.restore(),!0):(e.restore(),!1)})(a,i,t)&&n.setState({draggingVectorIdx:i,isVectorDragging:!0})})),n.circles.forEach((function(a,i){e.isPointInPath(a,t.offsetX,t.offsetY)&&n.setState({isDragging:!0,whichBall:i})})))})),t.addEventListener("mouseup",(function(t){t.preventDefault(),t.stopPropagation(),n.setState({isDragging:!1,whichBall:null,isVectorDragging:!1,draggingVectorIdx:null})})),t.addEventListener("mousemove",(function(t){if(!i&&n.state.isDragging){t.preventDefault(),t.stopPropagation();var e=n.getMousePos(t);n.props.handleDragDrop(e,n.state.whichBall)}else if(!i&&n.state.isVectorDragging){var a=n.getMousePos(t);n.props.handleVectorDrag(a,n.state.draggingVectorIdx)}})))},n.showBall=function(t,e,a,i,s){var o,r=n.canvasRef.current.getContext("2d"),l=new Path2D;o=a>800?15:a>600?12:a>400?10:a>100?8:6,l.arc(Math.round(t),Math.round(e),o,0,2*Math.PI),r.fillStyle=s,r.fill(l),n.circles[i]=l},n.backGround=function(){var t=n.canvasRef.current.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height)},n.state={listeners:[],isDragging:!1,whichBall:null,dragOk:!1,receivedLocs:!1},n.canvasRef=s.a.createRef(),n.circles=[],n.arrows=[],n.ballLocs=[],n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){this.canvasRef.current.width=.8*document.getElementById("canvasContainer").clientWidth,this.canvasRef.current.height=document.getElementById("canvasContainer").clientHeight}},{key:"componentDidUpdate",value:function(){var t=this,e=this.props.locations;this.ballLocs=Object(l.a)(e),this.props.traces||this.backGround(),e.forEach((function(e,a){t.showBall(e.pos.x,e.pos.y,e.mass,a,e.color)})),this.drawArrows(),e.length&&!this.state.receivedLocs&&this.setState({receivedLocs:!0},(function(){t.addBallEventListeners()}))}},{key:"getMousePos",value:function(t){var e=this.canvasRef.current.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}},{key:"render",value:function(){return Object(n.jsx)("canvas",{ref:this.canvasRef,style:{border:1,borderStyle:"solid",backgroundColor:"MidnightBlue"}})}}]),a}(s.a.Component),x=function(t){Object(h.a)(a,t);var e=Object(u.a)(a);function a(t){var n;return Object(c.a)(this,a),(n=e.call(this,t)).updateAnimationState=function(){n.rAF=requestAnimationFrame(n.updateAnimationState)},n.selectNumberBalls=function(t){var e=n.balls;switch(e.clearBallsList(),t.target.value){case"1":e.addBall({x:500,y:500,Vx:0,Vy:1,mass:1e3,color:"yellow"});break;case"2":e.addBall({x:500,y:500,Vx:0,Vy:-20,mass:1e3,color:"yellow"}),e.addBall({x:50,y:500,Vx:0,Vy:-25,mass:20,color:"aqua"});break;case"3":e.addBall({x:500,y:500,Vx:0,Vy:1,mass:1e3,color:"yellow"}),e.addBall({x:870,y:500,Vx:0,Vy:-25,mass:20,color:"aqua"}),e.addBall({x:890,y:500,Vx:0,Vy:-10,mass:1,color:"springGreen"});break;case"4":e.addBall({x:500,y:500,Vx:0,Vy:1,mass:1e3,color:"yellow"}),e.addBall({x:870,y:500,Vx:0,Vy:-25,mass:20,color:"aqua"}),e.addBall({x:890,y:500,Vx:0,Vy:-10,mass:1,color:"springGreen"}),e.addBall({x:250,y:200,Vx:5,Vy:5,mass:1,color:"red"})}n.setInitBallInfoState()},n.stopStart=function(t){n.setState({running:!n.state.running},(function(){n.worker.postMessage({type:"running",info:n.state.running,animationInfo:n.state.animationInfo}),n.state.running||(n.worker.terminate(),n.worker=new g,n.worker.addEventListener("message",(function(t){n.setState({animationInfo:t.data,awaitingData:!1})})))}))},n.handleDragDrop=function(t,e){n.setState({allowDragging:!1}),n.balls.updateBallData(n.state.animationInfo),n.balls.editBallLocation(e,t);var a=n.balls.getBalls();n.setState({animationInfo:a,initPositions:Object(l.a)(a)}),n.setInitBallInfoState()},n.handleVectorDrag=function(t,e){n.setState({allowDragging:!1}),n.balls.editBallVelocity(e,t);var a=n.balls.getBalls();n.setState({animationInfo:a,initPositions:Object(l.a)(a)})},n.resetPositionsToInit=function(){n.balls.resetBallLocations(n.state.initPositions),n.setState({animationInfo:Object(l.a)(n.state.initPositions)})},n.setInitBallInfoState=function(){var t=n.balls.getBalls();n.setState({animationInfo:t,initPositions:Object(l.a)(t)})},n.toggleTraces=function(t){n.setState({traces:!n.state.traces})},n.handleChangeMass=function(t){var e=t.target.valueAsNumber,a=parseInt(t.target.id[t.target.id.length-1]);if("number"===typeof e&&e>0){n.balls.changeMass(e,a);var i=n.balls.getBalls();n.setState({animationInfo:i,initPositions:Object(l.a)(i)})}},n.state={animationInfo:[],running:!1,showTraces:!1,allowDragging:!0,isDragging:!1,initPositions:[],draggingVectorIdx:!1,isVectorDragging:!1,awaitingData:!1},n.balls=new m(400),n.worker=new g,n}return Object(d.a)(a,[{key:"componentDidMount",value:function(){var t=this;this.rAF=requestAnimationFrame(this.updateAnimationState),this.worker.addEventListener("message",(function(e){t.setState({animationInfo:e.data,awaitingData:!1})})),console.log("Basic worker version")}},{key:"componentWillUnmount",value:function(){cancelAnimationFrame(this.rAF),this.worker.terminate()}},{key:"render",value:function(){return Object(n.jsxs)(s.a.Fragment,{children:[Object(n.jsx)(p,{locations:this.state.animationInfo,running:this.state.running,traces:this.state.traces,allowDragging:this.state.allowDragging,handleDragDrop:this.handleDragDrop,handleVectorDrag:this.handleVectorDrag,handleVectorDown:this.handleVectorDown}),Object(n.jsx)(v,{running:this.state.running,startHandler:this.stopStart,selectNumberBalls:this.selectNumberBalls,animationInfo:this.state.animationInfo,toggleTraces:this.toggleTraces,reset:this.resetPositionsToInit,handleChangeMass:this.handleChangeMass})]})}}]),a}(s.a.Component);var b=function(){return Object(n.jsx)("div",{className:"App",style:{display:"flex",flexDirection:"row",height:"98vh"},children:Object(n.jsx)("div",{id:"canvasContainer",style:{display:"flex",flexDirection:"row",width:"100%",marginTop:10,marginLeft:10,marginBottom:10,minHeight:"100%"},children:Object(n.jsx)(x,{})})})},y=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,17)).then((function(e){var a=e.getCLS,n=e.getFID,i=e.getFCP,s=e.getLCP,o=e.getTTFB;a(t),n(t),i(t),s(t),o(t)}))};r.a.render(Object(n.jsx)(s.a.StrictMode,{children:Object(n.jsx)(b,{})}),document.getElementById("root")),y()}},[[16,1,2]]]);
//# sourceMappingURL=main.bd89d411.chunk.js.map